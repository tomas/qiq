var qiq=function(){var i={},d=/\{\{ ?| ?\}\}/;function y(e){return e.name||(e.toString().match(/function (.+?)\(/)||[,""])[1]}function k(e,n){var r=e,t=n.split(".");for(var i in t){if(!r[n=t[i]])return;r=r[n]}return r}function v(e,n,r,t){var i=e.constructor==Object&&-1<n.indexOf(".")?k(e,n):e[n];if(4==r)return!(v.last=i)||void 0!==i.length&&!i.length?"":t(e);if(1<r&&v.last&&(!Array.isArray(v.last)||v.last.length))return v.last=null,"";if(Array.isArray(i))return r%3==0?i.length?"":t(e):1==r?i.map(t).join(""):t(i);if(1==r&&i&&i.constructor===Object)return t(i);if("function"==typeof i){if("boolean"!=typeof(i=i.call(e,t(e))))return i;i||2!==r||(i=!i)}return r%3==0&&(i=!i),(v.last=i)?t(e):""}function w(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(e,n){n=n||{};for(var r,t,i,o,u,c=[],l={},s=[],a=e.split(n.delimiter||d),p=n.escapeNewLines?"\\\\\\n":"\\n",f=n.helpers,h=y(w),g=y(v),m=0;m<a.length;++m)if(r=a[m],m%2==0)c.push('"'+r.replace(/"/g,'\\"')+'"');else switch(r[0]){case"/":""!=(r=r.slice(1))&&s[s.length-1]!=r||(c.push("})+"),s.pop(),delete l[r]);break;case"^":r=r.slice(1),t=0,s.push(r),b(r),x(l[r]),l[r]=t,c.push("+"+g+'(o,"'+r+'",'+t+",function(o,i){return ");break;case"#":r=r.slice(1),t=1,s.push(r),b(r),x(r,l[r]),l[r]=t,c.push("+"+g+'(o,"'+r+'",'+t+",function(o,i){return ");break;case"!":b(r=r.slice(1)),c.push("+o."+r+"+");break;case"_":""!=(r=r.slice(1))&&"else"!=r||(r=s[s.length-1]),t=l[r]+2,c.push("})+"+g+'(o,"'+r.replace(/\?$/,"")+'",'+t+",function(o,i){return ");break;default:if("?"==r.slice(-1))t=4,s.push(r),x(r,l[r]),l[r]=t,c.push("+"+g+'(o,"'+r.slice(0,-1)+'",'+t+",function(o){return ");else if(r.match(/(.+)\((.*)\)/)){if(i=RegExp.$1,o=RegExp.$2,!f[i])throw new Error('unknown helper "'+i+'"');o=o.split(",").map(function(e){return'"'==e[0]||"'"==e[0]||parseInt(e)==e||1==e||0==e?e:"o."+e.trim()}),c.push("+helpers."+i+"("+o+")+")}else b(r),r="this"==r?"o":"i"==r?"i":"o."+r,c.push("+"+h+"("+r+")+")}return c="\n"+((u=f)?"var helpers = {\n"+Object.keys(u).map(function(e){return"  "+e+": "+u[e].toString()}).join(",\n")+"\n};\n\n":"")+q(w.toString())+";\n\n"+q(v.toString())+";\n\n"+q(k.toString())+";\n\n return "+c.join("").replace(/\r?\n/g,p),new Function("o",c)}function b(e){if(!e.match(/^[\w.\[\]\"\\']+$/))throw new Error('invalid property "'+e+'"')}function x(e,n){if(void 0!==n)throw new Error('cannot overwrite existing conditional for "'+e+'"')}function q(e){return e.replace(/^/gm,"  ")}return{render:function(e,n,r){n=n||{};var t=(r=r||{}).key&&i[r.key]||o(e,r);return r.key&&!i[r.key]&&(i[r.key]=t),t(n)},compile:o}}();"undefined"!=typeof module&&module.exports&&(exports=module.exports=qiq.render,exports.compile=qiq.compile);
