var qiq2=function(){function i(e,t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)e[i]?console.warn("Cannot overwrite "+i+" property"):e[i]=n[i]}return e}var t=/[&<>"']/,x=/[?!#@_\/]/,n={"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},"<":function(e,t){return Number(e)<Number(t)},"<=":function(e,t){return Number(e)<=Number(t)},">":function(e,t){return Number(e)>Number(t)},">=":function(e,t){return Number(e)>=Number(t)}},u={h:function(e){return e&&e.replace&&t.test(e)?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):e},decode:decodeURIComponent,encode:encodeURIComponent,upper:function(e){return e.toUpperCase()},lower:function(e){return e.toLowerCase()},slug:function(e){return e.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/ /g,"-")}},o={c:function(e,t,r){return n[e](t,r)},a:function(e){return Array.isArray(e)?0===e.length?null:e:e?[e]:null},b:function(e){return!(!e||0==e.length)},v:function(e,t,r,n){return"function"==typeof e?e.call(n,t,r):e},d:function(e,t,r,n){return"function"==typeof e?e.call(n,t,r):null==e?"":e}};function r(a,c){c=c||{};var l=[],o=l,s=[];function f(e){c.htmltrim&&(e=(e=e.replace(/[\r\n]+\s*/g,"")).replace(/\\/g,"\\\\")),e=e.replace(/'/g,"\\'");var t=o.length-1,r=o[t];"string"!=typeof r?o.push(e):o[t]=r+e}function p(e){o.push(e)}function g(e){e.buf=[],e.cur=e.buf,o=e.buf,s.push(e)}function d(){return s[s.length-1]}function h(e){var t,r,n={type:e[0],tag:e};if(x.test(n.type))n.tag=e.substring(1).split(/ |\?/)[0];else{if(0<=e.indexOf("(")||0<=e.indexOf(";"))return void console.warn("invalid tag:",e);if("?"!=e.slice(-1))return n.type="r",function(e,t){var r=new RegExp("([ ]*\\|[ ]*\\w+)+","g").exec(e);if(r){t.tag=e.substring(0,r.index);var n=r[0].replace(/ /g,"").substring(1).split("|"),i=n.indexOf("raw");-1<i?n.splice(i,1):n.push("h"),t.f=n}else t.f=["h"]}(e,n),p(n),1;n.type="?",n.tag=e.slice(0,-1)}switch(n.type){case"?":case"!":case"#":p(n),g(n);break;case"@":var i=e.match(/if (.+)\s?(==|!=|<|>|<=|>=?)\s?(.+)/);if(!i)return;n.method=i[2],n.params={key:i[1].trim(),value:i[3].trim()},p(n),g(n);break;case"_":!function(e){var t=d();if(!t)throw new Error("no block, cannot add body");if("else"!=(e=e||"else"))throw new Error("invalid tag: _"+e+", should be _else");t.bods=t.bods||{},t.bods[e]=[],o=t.cur=t.bods[e]}(n.tag);break;case"/":var u=(t=s.pop(),r=d(),o=r&&r.cur||l,t);u?n.tag&&u.tag!==n.tag&&console.warn("tag mismatch",u.tag,n.tag):console.warn("extra closing /")}return 1}return function(){a=c.htmltrim?a.replace(/^\s+/g,""):a.replace(/\r/g,"\\r").replace(/\n/g,"\\n");for(var e,t,r=(c||{}).delimiters||["{{","}}"],n=new RegExp("(.*?)\\"+r[0]+"\\s*","msg"),i=new RegExp("(.*?)\\"+r[1],"msg"),u=0;null!==(e=n.exec(a));){e[1]&&f(e[1]),u=e.index+e[0].length;var o="";for(i.lastIndex=u;null!==(t=i.exec(a))&&(o+=t[1],-1!==t[1].lastIndexOf(r[0]));)o+=r[1];if(!t)throw new Error("No "+r[1]+"at idx",u);u=t.index+t[0].length,n.lastIndex=u,h(o.trim())||f("{"+o+"}")}if(0<s.length)throw new Error("Missing closing tag for",s[0].type,s[0].tag);return u<a.length&&f(a.slice(u)),l}()}function a(e){var u=0,o="var r='',l=l||{},c=c||{ctx:[]};var a=s?function(x){s.write(String(x))}:function(x){r+=x};";function a(e){e.forEach(function(e){if("r"===e.type)o+="a("+(i=f((n=e).tag,"u.d"),n.f&&n.f.forEach(function(e){i="u.f."+e+"("+i+",l,c)"}),i)+");";else if("?"===e.type||"!"===e.type){var t="!"===e.type?"!":"";l(),o+="if("+t+"u.b("+f(e.tag)+")){",a(e.buf),o+="}",c(e),s()}else if("#"===e.type){u++,l(!0),o+="var a"+(r=u)+"=u.a("+f(e.tag)+");",o+="if(a"+r+"){",e.buf?(o+="l.$len=a"+r+".length;",o+="for(var i"+r+"=0;i"+r+"<a"+r+".length;i"+r+"++){",o+="l._it=a"+r+"[i"+r+"];",o+="l.$idx=i"+r+";",a(e.buf),o+="}"):o+="a(a"+r+")",o+="}",c(e),s(!0)}else if("@"===e.type){var r;o+="var h"+(r=++u)+"=u.c('"+e.method+"',"+f(e.params.key)+","+e.params.value+",l);",o+="if(h"+r+"){",e.buf?a(e.buf):o+="a(h"+r+");",o+="}",c(e)}else e.type||(o+="a('"+e+"');");var n,i})}function c(e){e.bods&&e.bods.else&&(o+="else{",a(e.bods.else),o+="}")}function l(e){o+="var ctx"+u+"={};",e&&(o+="ctx"+u+"._it=l._it;",o+="ctx"+u+".idx=l.$idx;",o+="ctx"+u+".length=l.$len;"),o+="c.ctx.push(ctx"+u+");"}function s(e){o+="var p_ctx"+u+"=c.ctx.pop();",e&&(o+="l._it=p_ctx"+u+"._it;",o+="l.$idx=p_ctx"+u+".idx;",o+="l.$len=p_ctx"+u+".length;")}function f(e,t){if(t=t||"u.v",!isNaN(e))return e;if("'"==e[0]||'"'==e[0])return t+"("+e+",l._it,l,c)";if("."===e.trim())return"l._it";"."===e[0]&&(e="_it"+e);var r,n,i=[],u=!1,o=0;for(r=0;r<e.length;r=1+r)n=e[r],u||"."!==n&&"["!==n?"]"===n&&(i.push("["+f(e.substring(o,r))+"]"),u=!1,o=r+1):(o<r&&i.push(e.substring(o,r)),o=r+1,u="["===n);o<r&&i.push(e.substring(o,r));var a="l",c=[];if(i.forEach(function(e){"["===e[0]?a+=e:a+="."+e,c.push(a)}),1===c.length)return t+"("+c[0]+",l._it,l,c)";var l=c.slice(0,-1);return t+"("+c.join("&&")+","+l.join("&&")+",l,c)"}return a(e),new Function("l","u","c","s",o+"return r;")}return{setup:function(e){e&&e.filters&&i(u,e.filters)},compile:function(e,t){return a(r(e,t))},render:function(e,t,r,n){return o.f=r&&r.filters?i({},u,r.filters):u,e(t,o,r&&r.context,n)}}}();"undefined"!=typeof module&&module.exports&&(exports=module.exports=qiq2.render,exports.compile=qiq2.compile,exports.setup=qiq2.setup);
